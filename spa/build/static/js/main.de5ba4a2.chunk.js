(this.webpackJsonpspa=this.webpackJsonpspa||[]).push([[0],{18:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),c=n.n(s),r=n(20),l=n.n(r),o=(n(28),n(29),n(3)),i=(n(18),c.a.createContext()),d=n(7),u=n.n(d),j=n(9),m=n(11),b=n(12),h=(n(31),"http://13.71.16.202:8000/");function v(){var e=Object(s.useContext)(i),t=e.setAuthToken,n=(e.authToken,e.setRefreshToken),c=e.setUser,r=Object(s.useState)({username:"",password:""}),l=Object(o.a)(r,2),d=l[0],v=l[1],f=Object(s.useState)(null),O=Object(o.a)(f,2),x=O[0],p=O[1],g=Object(s.useState)(null),N=Object(o.a)(g,2),E=N[0],S=N[1],C=function(e){e.target&&v(Object(b.a)(Object(b.a)({},d),{},Object(m.a)({},e.target.name,e.target.value)))},k=function(){var e=Object(j.a)(u.a.mark((function e(a){var s,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),S(!0),p(null),e.prev=3,e.next=6,fetch(h+"departments/auth/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 6:return s=e.sent,e.next=9,s.json();case 9:if(r=e.sent,S(!1),200===s.status){e.next=14;break}return p(r),e.abrupt("return");case 14:r.access&&(l={name:r.name,image:r.image},t(r.access),n(r.refresh),c(l),localStorage.setItem("authToken",r.access),localStorage.setItem("refreshToken",r.refresh),localStorage.setItem("user",JSON.stringify(l)),localStorage.setItem("expires",(new Date).getTime()+828e5)),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(3),console.log("Error Getting Auth Token - Err : ",e.t0.message),S(!1),p({detail:"Network Error"});case 22:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"main",children:[Object(a.jsx)("div",{className:"heading",children:Object(a.jsx)("h1",{children:"Nimbus"})}),Object(a.jsx)("div",{className:"container",children:Object(a.jsxs)("div",{className:"login",children:[Object(a.jsx)("div",{className:"info info-2",children:"Nimbus Events"}),Object(a.jsx)("div",{className:"info",children:"Create Read Update Delete"}),Object(a.jsxs)("div",{className:"form-container",children:[Object(a.jsxs)("div",{className:"heading",children:[Object(a.jsx)("h1",{children:"Admin"}),Object(a.jsx)("h3",{children:"NIMBUS Clubs and Event Managers"})]}),Object(a.jsxs)("form",{onSubmit:k,children:[Object(a.jsx)("div",{className:"form-row",children:Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"username",children:"Username"}),Object(a.jsx)("input",{required:!0,className:"form-control",type:"text",id:"username",name:"username",value:d.username,onChange:C,placeholder:"username",autoComplete:"off"})]})}),Object(a.jsx)("div",{className:"form-row",children:Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"password",children:"Password"}),Object(a.jsx)("input",{required:!0,className:"form-control",type:"password",id:"password",name:"password",value:d.password,onChange:C,placeholder:"********",autoComplete:"off"})]})}),Object(a.jsx)("div",{className:"form-row",children:x?Object(a.jsx)("div",{className:"error",children:x.detail}):null}),E?Object(a.jsx)("div",{className:"form-control",children:Object(a.jsx)("div",{class:"progress-horizontal",children:Object(a.jsx)("div",{class:"bar-horizontal"})})}):null,Object(a.jsx)("div",{className:"form-row",children:Object(a.jsx)("button",{type:"submit",className:"btn-submit",children:"Login"})})]})]})]})})]})}n(32),n(33);function f(e){var t,n,c=e.editEvent,r=e.setEditEvent,l=e.getEvents,d=Object(s.useState)(c),v=Object(o.a)(d,2),f=v[0],O=v[1],x=Object(s.useState)(null),p=Object(o.a)(x,2),g=p[0],N=p[1],E=Object(s.useState)(!1),S=Object(o.a)(E,2),C=S[0],k=S[1],y=Object(s.useContext)(i).authToken,T=function(e){O(Object(b.a)(Object(b.a)({},f),{},Object(m.a)({},e.target.name,e.target.value)))},w=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,a,s,c,o,i,d,j,m,b,v,O;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!C){e.next=3;break}return e.abrupt("return");case 3:if(N(null),k(!0),f.id){e.next=31;break}for(a in console.log("Creating Event - ",f),e.prev=7,n=new FormData,f)["name","id","info","venue","start","end","regURL","Type","department"].includes(a)&&n.append(a,f[a]);return s=document.querySelector("#image"),c=document.querySelector("#abstract"),s.files[0]&&n.append("image",s.files[0]),c.files[0]&&n.append("abstract",c.files[0]),e.next=16,fetch(h+"events/",{method:"POST",headers:{Authorization:"Bearer ".concat(y)},body:n});case 16:return o=e.sent,e.next=19,o.json();case 19:i=e.sent,[200,201].includes(o.status)?(k(!1),N("success"),l(),setTimeout((function(){r(null)}),1e3)):(k(!1),N(JSON.stringify(i))),console.log("Created Event - ",i),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(7),console.log("Error while Creating Event - ",e.t0.message),k(!1),N(e.t0.message);case 29:e.next=54;break;case 31:for(j in console.log("Updating Event ",f),e.prev=32,d=new FormData,f)["name","id","info","venue","start","end","regURL","Type","department"].includes(j)&&d.append(j,f[j]);return m=document.querySelector("#image"),b=document.querySelector("#abstract"),m.files[0]&&d.append("image",m.files[0]),b.files[0]&&d.append("abstract",b.files[0]),e.next=41,fetch(h+"events/"+f.id,{method:"PUT",headers:{Authorization:"Bearer ".concat(y)},body:d});case 41:return v=e.sent,e.next=44,v.json();case 44:O=e.sent,[200,201].includes(v.status)?(k(!1),N("success"),l(),setTimeout((function(){r(null)}),1e3)):(k(!1),N(JSON.stringify(O))),console.log("Created Event - ",O),e.next=54;break;case 49:e.prev=49,e.t1=e.catch(32),console.log("Error while Creating Event - ",e.t1.message),k(!1),N(e.t1.message);case 54:case"end":return e.stop()}}),e,null,[[7,24],[32,49]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){c.id||O({name:"",info:"",venue:"",start:"",end:"",regURL:"",Type:2})}),[c]),f?Object(a.jsx)("div",{className:"edit-event",children:Object(a.jsx)("div",{className:"form-container",children:Object(a.jsxs)("form",{onSubmit:w,children:[Object(a.jsxs)("div",{className:"form-row",children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"name",children:"Event Name * "}),Object(a.jsx)("input",{required:!0,type:"text",name:"name",id:"name",value:f.name,onChange:T,placeholder:"Display Name of Event",className:"form-control",autoComplete:"off"})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"venue",children:"Venue * "}),Object(a.jsx)("input",{required:!0,type:"text",name:"venue",id:"venue",value:f.venue,onChange:T,placeholder:"Online - Google Meet, ( meet link etc. if exists )",className:"form-control",autoComplete:"off"})]})]}),Object(a.jsxs)("div",{className:"form-row",children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"start",children:"Start * "}),Object(a.jsx)("input",{required:!0,type:"datetime-local",name:"start",id:"start",value:null===(t=f.start)||void 0===t?void 0:t.replace("Z",""),onChange:T,placeholder:"",className:"form-control",autoComplete:"off"})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"end",children:"End * "}),Object(a.jsx)("input",{required:!0,type:"datetime-local",name:"end",id:"end",value:null===(n=f.end)||void 0===n?void 0:n.replace("Z",""),onChange:T,placeholder:"",className:"form-control",autoComplete:"off"})]})]}),Object(a.jsx)("div",{className:"form-row",children:Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"info",children:"Description * "}),Object(a.jsx)("textarea",{required:!0,type:"text",name:"info",id:"info",value:f.info,onChange:T,placeholder:"Textual description of Event Which will be shown on website - Full detailed description can be provided seperately in the PDF",className:"form-control",autoComplete:"off"})]})}),Object(a.jsxs)("div",{className:"form-row",children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"Type",children:"Type * "}),Object(a.jsxs)("select",{name:"Type",id:"Type",className:"form-control",onChange:T,value:f.Type,children:[Object(a.jsx)("option",{value:"0",children:"Mega Event"}),Object(a.jsx)("option",{value:"1",children:"Institutional Event"}),Object(a.jsx)("option",{value:"2",children:"Departmental Event"}),Object(a.jsx)("option",{value:"3",children:"Lecture"}),Object(a.jsx)("option",{value:"4",children:"Workshop"})]})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"regURL",children:"Registration Url *"}),Object(a.jsx)("input",{required:!0,type:"url",name:"regURL",id:"regURL",value:f.regURL,onChange:T,placeholder:"Google Form Registration URL",className:"form-control",autoComplete:"off"})]})]}),Object(a.jsxs)("div",{className:"form-row",children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"image",children:"Image "}),Object(a.jsx)("input",{type:"file",name:"image",id:"image",accept:"image/*",className:"form-control"}),Object(a.jsx)("div",{className:"help-text",children:"Event Image / thumbnail [square fit]"})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"abstract",children:"Abstract"}),Object(a.jsx)("input",{type:"file",name:"abstract",id:"abstract",className:"form-control",accept:"image/*,.pdf",autoComplete:"off"}),Object(a.jsx)("div",{className:"help-text",children:"pdf containing full details of the event"})]})]}),Object(a.jsx)("div",{className:"form-row ctrl",children:Object(a.jsx)("button",{disabled:C,className:"btn green lg",children:C?"Saving":"success"===g?"Saved":"Save"})}),Object(a.jsx)("div",{className:"form-row error",children:g||null})]})})}):null}n(34);function O(e){var t=e.event,n=e.setDetailedEvent;return Object(a.jsx)("div",{className:"event-card",onClick:function(){return n(t)},children:Object(a.jsxs)("div",{className:"card",children:[Object(a.jsx)("div",{className:"img",children:Object(a.jsx)("img",{src:t.image?t.image:"",alt:"Event"})}),Object(a.jsxs)("div",{className:"txt",children:[Object(a.jsx)("div",{className:"title",children:t.name}),Object(a.jsx)("div",{className:"desc",children:t.info}),Object(a.jsxs)("div",{className:"date",children:[Object(a.jsx)("div",{className:"start",children:t.start}),Object(a.jsx)("div",{className:"end",children:t.end})]}),Object(a.jsx)("div",{className:"venue",children:t.venue}),Object(a.jsx)("div",{className:"details",children:"Details"})]})]})})}n(35);function x(e){var t,n=e.event,c=e.setDetailedEvent,r=e.setEditEvent,l=(e.onDeleteEvent,e.getEvents),d=(null!==(t=Object(s.useContext)(i))&&void 0!==t?t:{}).authToken,m=Object(s.useState)(),b=Object(o.a)(m,2),v=b[0],f=b[1],O=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(null),!n.id){e.next=13;break}return e.prev=2,e.next=5,fetch(h+"events/"+n.id,{method:"DELETE",headers:{Authorization:"Bearer ".concat(d)}});case 5:t=e.sent,[200,201,204].includes(t.status)?(console.log("Deleted Event - ",t.status),f({detail:"Deleted Event Successfully."}),l()):403==t.status?(console.log("Cant Delete Event -",t.status),f({detail:"UnAuthorized Access."})):(console.log("Cant Delete Event -",t.status),f({detail:"Cant Delete Event"})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log("Failed to delete Event - ",e.t0.message),f({detail:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"event-details",children:[Object(a.jsxs)("div",{className:"ctrl",children:[Object(a.jsx)("button",{className:"btn back lg",onClick:function(){return c(null)},children:"<"}),r?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{className:"btn blue",onClick:function(){return r(n)},children:"edit"}),Object(a.jsx)("button",{className:"btn red",onClick:O,children:"delete"})]}):null]}),Object(a.jsx)("div",{className:"ctrl error",children:v?v.detail:null}),Object(a.jsx)("pre",{className:"event",children:JSON.stringify(n,void 0,2)})]})}function p(){var e=Object(s.useContext)(i),t=e.user,n=e.setUser,c=e.authToken,r=e.setAuthToken,l=e.setRefreshToken,d=Object(s.useState)([]),u=Object(o.a)(d,2),j=u[0],m=u[1],b=Object(s.useState)(null),v=Object(o.a)(b,2),p=v[0],g=v[1],N=Object(s.useState)(null),E=Object(o.a)(N,2),S=E[0],C=E[1],k=function(){fetch(h+"events?department=".concat(t.name),{method:"GET",headers:{Authorization:"Bearer ".concat(c)}}).then((function(e){return e.json()})).then((function(e){m(e)})).catch((function(e){console.log("Cant Get Events Error - ",e.message)}))};return Object(s.useEffect)((function(){c&&k()}),[c]),t?Object(a.jsxs)("div",{className:"main dashboard",children:[Object(a.jsxs)("div",{className:"heading",children:[Object(a.jsx)("h1",{children:null===t||void 0===t?void 0:t.name}),Object(a.jsxs)("div",{className:"user-actions",children:[Object(a.jsx)("button",{className:"btn logout",onClick:function(){r(null),l(null),n(null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("expires")},children:"Logout"}),Object(a.jsx)("img",{src:null===t||void 0===t?void 0:t.image,alt:"avatar",className:"avatar"})]})]}),Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)("div",{className:"ctrl",children:Object(a.jsx)("button",{className:"btn ".concat(p?"cancel":"create"),onClick:function(){g(p?null:{})},children:p?"Cancel":"Create Event"})}),p?Object(a.jsx)(f,{editEvent:p,setEditEvent:g,getEvents:k}):S?Object(a.jsx)(x,{event:S,setDetailedEvent:C,setEditEvent:g,onDeleteEvent:function(e){console.log("Event Deleted.")},getEvents:k}):Object(a.jsx)("div",{className:"events",children:j.length?j.map((function(e){return Object(a.jsx)(O,{event:e,setDetailedEvent:C})})):Object(a.jsx)("div",{className:"empty",children:Object(a.jsx)("p",{children:"You don't have any Events"})})})]})]}):null}function g(){var e=Object(s.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(null),l=Object(o.a)(r,2),d=l[0],u=l[1],j=Object(s.useState)("Club"),m=Object(o.a)(j,2),b=m[0],h=m[1];return Object(s.useEffect)((function(){var e=localStorage.getItem("authToken"),t=localStorage.getItem("refreshToken"),n=JSON.parse(localStorage.getItem("user")),a=localStorage.getItem("expires");e&&a>(new Date).getTime()&&(console.log("Got Local Auth Token"),c(e),u(t),h(n))}),[]),Object(a.jsx)(i.Provider,{value:{authToken:n,setAuthToken:c,refreshToken:d,setRefreshToken:u,user:b,setUser:h},children:n?Object(a.jsx)(p,{}):Object(a.jsx)(v,{})})}var N=n(21),E=n(2);n(36);function S(){var e=Object(s.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(null),l=Object(o.a)(r,2),i=l[0],d=l[1],m=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(h+"events");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,[200,201].includes(t.status)&&(console.log("Got Events."),c(n)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Cant Get Events - ",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){m()}),[]),Object(a.jsxs)("div",{className:"main events-page",children:[Object(a.jsx)("div",{className:"heading",children:Object(a.jsx)("h1",{children:"Events"})}),Object(a.jsx)("div",{className:"container",children:i?Object(a.jsx)(x,{event:i,setDetailedEvent:d}):Object(a.jsx)("div",{className:"events",children:n.map((function(e){return Object(a.jsx)(O,{event:e,setDetailedEvent:d})}))})})]})}var C=function(){return Object(a.jsxs)(N.a,{children:[Object(a.jsx)(E.a,{path:"/admin",exact:!0,component:g}),Object(a.jsx)(E.a,{path:"/events",exact:!0,component:S})]})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};l.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(C,{})}),document.getElementById("root")),k()}},[[42,1,2]]]);
//# sourceMappingURL=main.de5ba4a2.chunk.js.map