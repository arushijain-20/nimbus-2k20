(this.webpackJsonpspa=this.webpackJsonpspa||[]).push([[0],{19:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(1),c=n.n(a),r=n(21),l=n.n(r),i=(n(28),n(29),n(2)),o=(n(19),c.a.createContext()),d=n(5),j=n.n(d),u=n(9),m=n(11),b=n(12),h=(n(31),"https://spartanbhardwaj.hopto.org/");function v(){var e=Object(a.useContext)(o),t=e.setAuthToken,n=(e.authToken,e.setRefreshToken),c=e.setUser,r=Object(a.useState)({username:"",password:""}),l=Object(i.a)(r,2),d=l[0],v=l[1],O=Object(a.useState)(null),x=Object(i.a)(O,2),f=x[0],p=x[1],g=Object(a.useState)(null),N=Object(i.a)(g,2),E=N[0],S=N[1],k=function(e){e.target&&v(Object(b.a)(Object(b.a)({},d),{},Object(m.a)({},e.target.name,e.target.value)))},w=function(){var e=Object(u.a)(j.a.mark((function e(s){var a,r,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),S(!0),p(null),e.prev=3,e.next=6,fetch(h+"departments/auth/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 6:return a=e.sent,e.next=9,a.json();case 9:if(r=e.sent,S(!1),200===a.status){e.next=14;break}return p(r),e.abrupt("return");case 14:r.access&&(l={name:r.name,image:r.image},t(r.access),n(r.refresh),c(l),localStorage.setItem("authToken",r.access),localStorage.setItem("refreshToken",r.refresh),localStorage.setItem("user",JSON.stringify(l)),localStorage.setItem("expires",(new Date).getTime()+828e5)),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(3),console.log("Error Getting Auth Token - Err : ",e.t0.message),S(!1),p({detail:"Network Error"});case 22:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"main",children:[Object(s.jsx)("div",{className:"heading",children:Object(s.jsx)("h1",{children:"Nimbus"})}),Object(s.jsx)("div",{className:"container",children:Object(s.jsxs)("div",{className:"login",children:[Object(s.jsx)("div",{className:"info info-2",children:"Nimbus Events"}),Object(s.jsx)("div",{className:"info",children:"Create Read Update Delete"}),Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsxs)("div",{className:"heading",children:[Object(s.jsx)("h1",{children:"Admin"}),Object(s.jsx)("h3",{children:"NIMBUS Clubs and Event Managers"})]}),Object(s.jsxs)("form",{onSubmit:w,children:[Object(s.jsx)("div",{className:"form-row",children:Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"username",children:"Username"}),Object(s.jsx)("input",{required:!0,className:"form-control",type:"text",id:"username",name:"username",value:d.username,onChange:k,placeholder:"username",autoComplete:"off"})]})}),Object(s.jsx)("div",{className:"form-row",children:Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{required:!0,className:"form-control",type:"password",id:"password",name:"password",value:d.password,onChange:k,placeholder:"********",autoComplete:"off"})]})}),Object(s.jsx)("div",{className:"form-row",children:f?Object(s.jsx)("div",{className:"error",children:f.detail}):null}),E?Object(s.jsx)("div",{className:"form-control",children:Object(s.jsx)("div",{className:"progress-horizontal",children:Object(s.jsx)("div",{className:"bar-horizontal"})})}):null,Object(s.jsx)("div",{className:"form-row",children:Object(s.jsx)("button",{type:"submit",className:"btn-submit",children:"Login"})})]})]})]})})]})}n(32),n(33);function O(e){var t,n,c=e.editEvent,r=e.setEditEvent,l=e.getEvents,d=Object(a.useState)(c),v=Object(i.a)(d,2),O=v[0],x=v[1],f=Object(a.useState)(null),p=Object(i.a)(f,2),g=p[0],N=p[1],E=Object(a.useState)(!1),S=Object(i.a)(E,2),k=S[0],w=S[1],C=Object(a.useContext)(o).authToken,T=function(e){x(Object(b.a)(Object(b.a)({},O),{},Object(m.a)({},e.target.name,e.target.value)))},y=function(){var e=Object(u.a)(j.a.mark((function e(t){var n,s,a,c,i,o,d,u,m,b,v,x;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!k){e.next=3;break}return e.abrupt("return");case 3:if(N(null),w(!0),O.id){e.next=31;break}for(s in console.log("Creating Event - ",O),e.prev=7,n=new FormData,O)["name","id","info","venue","start","end","regURL","Type","department"].includes(s)&&n.append(s,O[s]);return a=document.querySelector("#image"),c=document.querySelector("#abstract"),a.files[0]&&n.append("image",a.files[0]),c.files[0]&&n.append("abstract",c.files[0]),e.next=16,fetch(h+"events/",{method:"POST",headers:{Authorization:"Bearer ".concat(C)},body:n});case 16:return i=e.sent,e.next=19,i.json();case 19:o=e.sent,[200,201].includes(i.status)?(w(!1),N("success"),l(),setTimeout((function(){r(null)}),1e3)):(w(!1),N(JSON.stringify(o))),console.log("Created Event - ",o),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(7),console.log("Error while Creating Event - ",e.t0.message),w(!1),N(e.t0.message);case 29:e.next=54;break;case 31:for(u in console.log("Updating Event ",O),e.prev=32,d=new FormData,O)["name","id","info","venue","start","end","regURL","Type","department"].includes(u)&&d.append(u,O[u]);return m=document.querySelector("#image"),b=document.querySelector("#abstract"),m.files[0]&&d.append("image",m.files[0]),b.files[0]&&d.append("abstract",b.files[0]),e.next=41,fetch(h+"events/"+O.id,{method:"PUT",headers:{Authorization:"Bearer ".concat(C)},body:d});case 41:return v=e.sent,e.next=44,v.json();case 44:x=e.sent,[200,201].includes(v.status)?(w(!1),N("success"),l(),setTimeout((function(){r(null)}),1e3)):(w(!1),N(JSON.stringify(x))),console.log("Created Event - ",x),e.next=54;break;case 49:e.prev=49,e.t1=e.catch(32),console.log("Error while Creating Event - ",e.t1.message),w(!1),N(e.t1.message);case 54:case"end":return e.stop()}}),e,null,[[7,24],[32,49]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){c.id||x({name:"",info:"",venue:"",start:"",end:"",regURL:"",Type:0})}),[c]),O?Object(s.jsx)("div",{className:"edit-event",children:Object(s.jsx)("div",{className:"form-container",children:Object(s.jsxs)("form",{onSubmit:y,children:[Object(s.jsxs)("div",{className:"form-row",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"name",children:"Event Name * "}),Object(s.jsx)("input",{required:!0,type:"text",name:"name",id:"name",value:O.name,onChange:T,placeholder:"Display Name of Event",className:"form-control",autoComplete:"off"})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"venue",children:"Venue * "}),Object(s.jsx)("input",{required:!0,type:"text",name:"venue",id:"venue",value:O.venue,onChange:T,placeholder:"Online - Google Meet, ( meet link etc. if exists )",className:"form-control",autoComplete:"off"})]})]}),Object(s.jsxs)("div",{className:"form-row",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"start",children:"Start * "}),Object(s.jsx)("input",{required:!0,type:"datetime-local",name:"start",id:"start",value:null===(t=O.start)||void 0===t?void 0:t.replace("Z",""),onChange:T,placeholder:"",className:"form-control",autoComplete:"off"})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"end",children:"End * "}),Object(s.jsx)("input",{required:!0,type:"datetime-local",name:"end",id:"end",value:null===(n=O.end)||void 0===n?void 0:n.replace("Z",""),onChange:T,placeholder:"",className:"form-control",autoComplete:"off"})]})]}),Object(s.jsx)("div",{className:"form-row",children:Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"info",children:"Description * "}),Object(s.jsx)("textarea",{required:!0,type:"text",name:"info",id:"info",value:O.info,onChange:T,placeholder:"Textual description of Event Which will be shown on website - Full detailed description can be provided seperately in the PDF",className:"form-control",autoComplete:"off"})]})}),Object(s.jsxs)("div",{className:"form-row",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"Type",children:"Type * "}),Object(s.jsxs)("select",{name:"Type",id:"Type",className:"form-control",onChange:T,value:O.Type,children:[Object(s.jsx)("option",{value:"0",children:"Departmental Event"}),Object(s.jsx)("option",{value:"1",children:"Institutional Event"}),Object(s.jsx)("option",{value:"2",children:"Talk"}),Object(s.jsx)("option",{value:"4",children:"Workshop"})]})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"regURL",children:"Registration Url *"}),Object(s.jsx)("input",{required:!0,type:"url",name:"regURL",id:"regURL",value:O.regURL,onChange:T,placeholder:"Google Form Registration URL",className:"form-control",autoComplete:"off"})]})]}),Object(s.jsxs)("div",{className:"form-row",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"image",children:"Image "}),Object(s.jsx)("input",{type:"file",name:"image",id:"image",accept:"image/*",className:"form-control"}),Object(s.jsx)("div",{className:"help-text",children:"Event Image / thumbnail [square fit]"})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"abstract",children:"Abstract"}),Object(s.jsx)("input",{type:"file",name:"abstract",id:"abstract",className:"form-control",accept:"image/*,.pdf",autoComplete:"off"}),Object(s.jsx)("div",{className:"help-text",children:"pdf containing full details of the event"})]})]}),Object(s.jsx)("div",{className:"form-row ctrl",children:Object(s.jsx)("button",{disabled:k,className:"btn green lg",children:k?"Saving":"success"===g?"Saved":"Save"})}),Object(s.jsx)("div",{className:"form-row error",children:g||null})]})})}):null}var x=n(14);n(34);function f(e){var t=e.event,n=e.setDetailedEvent;return Object(s.jsx)("div",{className:"event-card",onClick:n?function(){return n(t)}:function(){return null},children:Object(s.jsx)(x.b,{to:n?"/admin":"/events/".concat(t.id),children:Object(s.jsxs)("div",{className:"card",children:[Object(s.jsx)("div",{className:"img",children:t.image?Object(s.jsx)("img",{src:t.image?t.image:"",alt:"Event"}):null}),Object(s.jsxs)("div",{className:"txt",children:[Object(s.jsx)("div",{className:"title",children:t.name}),Object(s.jsx)("div",{className:"desc",children:t.info}),Object(s.jsxs)("div",{className:"date",children:[Object(s.jsx)("div",{className:"start",children:Object(s.jsxs)("time",{dateTime:t.start,children:[Object(s.jsx)("span",{className:"date",children:new Date(t.start).toDateString()}),Object(s.jsx)("span",{className:"time",children:new Date(t.start).toLocaleTimeString()})]})}),Object(s.jsx)("span",{className:"to",children:"-"}),Object(s.jsx)("div",{className:"end",children:Object(s.jsxs)("time",{dateTime:t.end,children:[Object(s.jsx)("span",{className:"date",children:new Date(t.end).toDateString()}),Object(s.jsx)("span",{className:"time",children:new Date(t.end).toLocaleTimeString()})]})})]}),Object(s.jsx)("div",{className:"venue",children:t.venue.includes("http")?Object(s.jsx)("a",{href:t.venue,children:t.venue}):t.venue})]})]})})})}n(40);function p(e){var t,n=e.event,c=e.setDetailedEvent,r=e.setEditEvent,l=(e.onDeleteEvent,e.getEvents),d=e.history,m=(null!==(t=Object(a.useContext)(o))&&void 0!==t?t:{}).authToken,b=Object(a.useState)(),v=Object(i.a)(b,2),O=v[0],x=v[1],f=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(null),!n.id){e.next=13;break}return e.prev=2,e.next=5,fetch(h+"events/"+n.id,{method:"DELETE",headers:{Authorization:"Bearer ".concat(m)}});case 5:t=e.sent,[200,201,204].includes(t.status)?(console.log("Deleted Event - ",t.status),x({detail:"Deleted Event Successfully."}),l()):403==t.status?(console.log("Cant Delete Event -",t.status),x({detail:"UnAuthorized Access."})):(console.log("Cant Delete Event -",t.status),x({detail:"Cant Delete Event"})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log("Failed to delete Event - ",e.t0.message),x({detail:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"event-details",children:[Object(s.jsxs)("div",{className:"ctrl",children:[d?null:Object(s.jsx)("button",{className:"btn back lg",onClick:function(){return c(null)},children:"<"}),r?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("button",{className:"btn blue",onClick:function(){return r(n)},children:"edit"}),Object(s.jsx)("button",{className:"btn red",onClick:f,children:"delete"})]}):null]}),Object(s.jsx)("div",{className:"ctrl error",children:O?O.detail:null}),Object(s.jsxs)("div",{className:"event-form",children:[Object(s.jsx)("div",{className:"event-pic",children:Object(s.jsx)("img",{src:n.image})}),Object(s.jsxs)("div",{className:"event-data",children:[Object(s.jsx)("div",{className:"event-name",children:n.name}),Object(s.jsxs)("div",{className:"event-club",children:["- Team ",n.department]}),Object(s.jsx)("div",{className:"event-description",children:n.info}),Object(s.jsxs)("div",{className:"btn-wrapper",children:[Object(s.jsx)("div",{className:"event-register-btn",children:Object(s.jsx)("a",{href:n.regURL,children:"Register"})}),Object(s.jsx)("div",{className:"event-register-btn",children:Object(s.jsx)("a",{href:n.abstract,children:"Abstract"})})]}),Object(s.jsxs)("div",{className:"other-data",children:[Object(s.jsx)("div",{className:"event-venue",children:Object(s.jsxs)("p",{children:["Venue : ",n.venue]})}),Object(s.jsxs)("div",{className:"event-timing",children:[Object(s.jsxs)("div",{className:"start",children:[Object(s.jsx)("span",{className:"date",children:new Date(n.start).toDateString()}),Object(s.jsx)("span",{className:"time",children:new Date(n.start).toLocaleTimeString()})]}),Object(s.jsx)("span",{className:"to",children:" - "}),Object(s.jsxs)("div",{className:"end",children:[Object(s.jsx)("span",{className:"date",children:new Date(n.end).toDateString()}),Object(s.jsx)("span",{className:"time",children:new Date(n.end).toLocaleTimeString()})]})]})]})]})]})]})}function g(){var e=Object(a.useContext)(o),t=e.user,n=e.setUser,c=e.authToken,r=e.setAuthToken,l=e.setRefreshToken,d=Object(a.useState)([]),j=Object(i.a)(d,2),u=j[0],m=j[1],b=Object(a.useState)(null),v=Object(i.a)(b,2),x=v[0],g=v[1],N=Object(a.useState)(null),E=Object(i.a)(N,2),S=E[0],k=E[1];function w(){fetch(h+"events?department=".concat(t.name),{method:"GET",headers:{Authorization:"Bearer ".concat(c)}}).then((function(e){return e.json()})).then((function(e){m(e)})).catch((function(e){console.log("Cant Get Events Error - ",e.message)}))}return Object(a.useEffect)((function(){c&&t&&w()}),[c,t]),Object(s.jsxs)("div",{className:"main dashboard",children:[Object(s.jsxs)("div",{className:"heading",children:[Object(s.jsx)("h1",{children:null===t||void 0===t?void 0:t.name}),Object(s.jsxs)("div",{className:"user-actions",children:[Object(s.jsx)("button",{className:"btn logout",onClick:function(){r(null),l(null),n(null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("expires")},children:"Logout"}),Object(s.jsx)("img",{src:null===t||void 0===t?void 0:t.image,alt:"avatar",className:"avatar"})]})]}),Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"ctrl",children:Object(s.jsx)("button",{className:"btn ".concat(x?"cancel":"create"),onClick:function(){g(x?null:{})},children:x?"Cancel":"Create Event"})}),x?Object(s.jsx)(O,{editEvent:x,setEditEvent:g,getEvents:w}):S?Object(s.jsx)(p,{event:S,setDetailedEvent:k,setEditEvent:g,onDeleteEvent:function(e){console.log("Event Deleted.")},getEvents:w}):Object(s.jsx)("div",{className:"events",children:u.length?u.map((function(e){return Object(s.jsx)(f,{event:e,setDetailedEvent:k},e.id)})):Object(s.jsx)("div",{className:"empty",children:Object(s.jsx)("p",{children:"You don't have any Events"})})})]})]})}function N(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),l=Object(i.a)(r,2),d=l[0],j=l[1],u=Object(a.useState)("Club"),m=Object(i.a)(u,2),b=m[0],h=m[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("authToken"),t=localStorage.getItem("refreshToken"),n=JSON.parse(localStorage.getItem("user")),s=localStorage.getItem("expires");e&&s>(new Date).getTime()&&(console.log("Got Local Auth Token"),c(e),j(t),h(n))}),[]),Object(s.jsx)(o.Provider,{value:{authToken:n,setAuthToken:c,refreshToken:d,setRefreshToken:j,user:b,setUser:h},children:n?Object(s.jsx)(g,{}):Object(s.jsx)(v,{})})}var E=n(3);n(41);function S(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],r=function(){var e=Object(u.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(h+"events");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,[200,201].includes(t.status)&&(console.log("Got Events."),c(n)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Cant Get Events - ",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){r()}),[]),Object(s.jsxs)("div",{className:"main events-page",children:[Object(s.jsx)("div",{className:"heading",children:Object(s.jsx)("h1",{children:"Events"})}),Object(s.jsx)("div",{className:"container",children:Object(s.jsx)("div",{className:"events",children:n.map((function(e){return Object(s.jsx)(f,{event:e},e.id)}))})})]})}n(42);function k(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),c=n[0],r=n[1],l=function(){var e=Object(u.a)(j.a.mark((function e(t){var n,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(h+"events/".concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:s=e.sent,[200,201].includes(n.status)&&(console.log("Got Events."),r(s)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Cant Get Events - #".concat(t),e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log(e.match.params.id),l(e.match.params.id)}),[e]),Object(s.jsxs)("div",{className:"main event-details",children:[Object(s.jsx)("div",{className:"heading",children:Object(s.jsx)("h1",{children:"Events"})}),Object(s.jsx)("div",{className:"container",children:c?Object(s.jsx)(p,{event:c,setDetailedEvent:r,history:e.history}):Object(s.jsx)("div",{children:"Fetching Event"})})]})}var w=function(){return Object(s.jsxs)(x.a,{children:[Object(s.jsx)(E.a,{path:"/admin",exact:!0,component:N}),Object(s.jsx)(E.a,{path:"/events",exact:!0,component:S}),Object(s.jsx)(E.a,{path:"/events/:id",exact:!0,component:k})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,44)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),s(e),a(e),c(e),r(e)}))};l.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(w,{})}),document.getElementById("root")),C()}},[[43,1,2]]]);
//# sourceMappingURL=main.8752c8dd.chunk.js.map